select `br`.`id` AS `id`,`br`.`bronto_subaccount` AS `bronto_subaccount`,concat(`br`.`bronto_subaccount`,`br`.`bronto_start_date`) AS `subaccount_and_date`,`br`.`num_sends` AS `num_sends`,`br`.`num_deliveries` AS `num_deliveries`,`br`.`num_bounces` AS `num_bounces`,`br`.`uniq_opens` AS `uniq_opens`,`br`.`num_opens` AS `num_opens`,`br`.`uniq_clicks` AS `uniq_clicks`,`br`.`num_clicks` AS `num_clicks`,`br`.`num_unsubscribes_by_prefs` AS `num_unsubscribes_by_prefs`,`br`.`num_unsubscribes_by_complaint` AS `num_unsubscribes_by_complaint`,`br`.`email_action_device_type` AS `email_Action_device_type`,`br`.`bronto_start_date` AS `bronto_start_date`,`br`.`bronto_end_date` AS `bronto_end_date`,`br`.`bronto_delivery_name` AS `bronto_delivery_name`,(case when ((`br`.`id` = 5188257) or (`br`.`bronto_subaccount` = '\'') or (`br`.`bronto_subaccount` = 'max=11453071360 for co') or (`br`.`bronto_subaccount` = 'Nations Info Corp') or (`br`.`bronto_subaccount` = 'rent2owninc2') or isnull(`br`.`bronto_subaccount`)) then 0 else `brand`.`id_brand` end) AS `id_brand`,(case `br`.`email_action_device_type` when NULL then 'NA' else `br`.`email_action_device_type` end) AS `device_type`,(case when (`br`.`isp` is not null) then `br`.`isp` else 'Other' end) AS `ISP`,if(isnull(`brand`.`ip`),'NA',`brand`.`ip`) AS `ip`,(case when (`br`.`bronto_delivery_name` in ('EM00A','EM00B','EM00C')) then 'EM00' when (`br`.`bronto_delivery_name` like 'EM%') then left(`br`.`bronto_delivery_name`,4) when (`br`.`bronto_delivery_name` in ('R2 EM00A','R2 EM00B')) then 'R2 EM00' when (`br`.`bronto_delivery_name` in ('R2 EM01A','R2 EM01B')) then 'R2 EM01' when (`br`.`bronto_delivery_name` in ('R2 EM02A','R2 EM02B')) then 'R2 EM02' when (`br`.`bronto_delivery_name` in ('R2 EM03A','R2 EM03B')) then 'R2 EM03' when (`br`.`bronto_delivery_name` in ('R2 EM04A','R2 EM04B')) then 'R2 EM04' when (`br`.`bronto_delivery_name` in ('R2 EM05A','R2 EM05B')) then 'R2 EM05' when (`br`.`bronto_delivery_name` in ('R2 EM06A','R2 EM06B')) then 'R2 EM06' when (`br`.`bronto_delivery_name` in ('R2 EM07A','R2 EM07B')) then 'R2 EM07' when (`br`.`bronto_delivery_name` in ('R2 EM08A','R2 EM08B')) then 'R2 EM08' when (`br`.`bronto_delivery_name` in ('R2 EM09A','R2 EM09B')) then 'R2 EM09' when (`br`.`bronto_delivery_name` in ('R2 EM10A','R2 EM10B')) then 'R2 EM10' when (`br`.`bronto_delivery_name` in ('R2 EM11A','R2 EM11B')) then 'R2 EM11' when (`br`.`bronto_delivery_name` in ('R2 EM12A','R2 EM12B')) then 'R2 EM12' when (`br`.`bronto_delivery_name` in ('R2 EM13A','R2 EM13B')) then 'R2 EM13' when (`br`.`bronto_delivery_name` in ('R2 EM14A','R2 EM14B')) then 'R2 EM14' when (`br`.`bronto_delivery_name` in ('R2 EM15A','R2 EM15B')) then 'R2 EM15' when (`br`.`bronto_delivery_name` in ('R2 EM16A','R2 EM16B')) then 'R2 EM16' when (`br`.`bronto_delivery_name` in ('R2 EM17A','R2 EM17B')) then 'R2 EM17' when (`br`.`bronto_delivery_name` in ('R2 EM18A','R2 EM18B')) then 'R2 EM18' when (`br`.`bronto_delivery_name` in ('R2 EM19A','R2 EM19B')) then 'R2 EM19' when (`br`.`bronto_delivery_name` in ('YSAM_EM00A','YSAM_EM00B')) then 'YSAM_EM00' when (`br`.`bronto_delivery_name` in ('YSAM_EM01A','YSAM_EM01B')) then 'YSAM_EM01' when (`br`.`bronto_delivery_name` in ('YSAM_EM02A','YSAM_EM02B')) then 'YSAM_EM02' when (`br`.`bronto_delivery_name` in ('YSAM_EM03A','YSAM_EM03B')) then 'YSAM_EM03' when (`br`.`bronto_delivery_name` in ('YSAM_EM04A','YSAM_EM04B')) then 'YSAM_EM04' when (`br`.`bronto_delivery_name` in ('YSAM_EM05A','YSAM_EM05B')) then 'YSAM_EM05' when (`br`.`bronto_delivery_name` in ('CSRC_EM00A','CSRC_EM00B','CSRC_EM00')) then 'CSRC_EM0' when (`br`.`bronto_delivery_name` in ('CSRC_EM01A','CSRC_EM01B','CSRC_EM01')) then 'CSRC_EM01' when (`br`.`bronto_delivery_name` in ('CSRC_EM02A','CSRC_EM02B','CSRC_EM02')) then 'CSRC_EM02' when (`br`.`bronto_delivery_name` in ('CSRC_EM03A','CSRC_EM03B','CSRC_EM03')) then 'CSRC_EM03' when (`br`.`bronto_delivery_name` in ('CSRC_EM04A','CSRC_EM04B','CSRC_EM04')) then 'CSRC_EM04' when (`br`.`bronto_delivery_name` in ('CSRC_EM05A','CSRC_EM05B','CSRC_EM05')) then 'CSRC_EM05' when (`br`.`bronto_delivery_name` in ('YSAM_W0A','YSAM_W0B','YSAM_W0')) then 'YSAM_W0' when (`br`.`bronto_delivery_name` in ('YSAM_W1A','YSAM_W1B','YSAM_W1')) then 'YSAM_W1' when (`br`.`bronto_delivery_name` in ('YSAM_W2A','YSAM_W2B','YSAM_W2')) then 'YSAM_W2' when (`br`.`bronto_delivery_name` in ('YSAM_W3A','YSAM_W3B','YSAM_W3')) then 'YSAM_W3' when (`br`.`bronto_delivery_name` in ('YSAM_W4A','YSAM_W4B','YSAM_W4')) then 'YSAM_W4' when (`br`.`bronto_delivery_name` in ('YSAM_W5A','YSAM_W5B','YSAM_W5')) then 'YSAM_W5' when (`br`.`bronto_delivery_name` in ('CSRC_W0A','CSRC_W0B','CSRC_W0')) then 'CSRC_W0' when (`br`.`bronto_delivery_name` in ('CSRC_W1A','CSRC_W1B','CSRC_W1')) then 'CSRC_W1' when (`br`.`bronto_delivery_name` in ('CSRC_W2A','CSRC_W2B','CSRC_W2')) then 'CSRC_W2' when (`br`.`bronto_delivery_name` in ('CSRC_W3A','CSRC_W3B','CSRC_W3')) then 'CSRC_W3' when (`br`.`bronto_delivery_name` in ('CSRC_W4A','CSRC_W4B','CSRC_W4')) then 'CSRC_W4' when (`br`.`bronto_delivery_name` in ('CSRC_W5A','CSRC_W5B','CSRC_W5')) then 'CSRC_W5' when (`br`.`bronto_delivery_name` in ('Monthly Email A','Monthly Email B')) then 'Monthly_Email' when (`br`.`bronto_delivery_name` in ('Weekly Email A','Weekly Email B')) then 'Weekly_Email' when (`br`.`bronto_delivery_name` in ('R2 Monthly Email A','R2 Monthly Email B')) then 'R2 Monthly Email' when (`br`.`bronto_delivery_name` in ('R2 Weekly Email A','R2 Weekly Email B')) then 'R2 Weekly Email' when (`br`.`bronto_delivery_name` = '1A Modern Template') then '1_Modern_Template' when (`br`.`bronto_delivery_name` = '1 Text Mostly') then '1_Text_Mostly' when (`br`.`bronto_delivery_name` = '1 Newsletter') then '1_Newsletter' when (`br`.`bronto_delivery_name` = '1 Newsletter A') then '1_Newsletter_A' when (`br`.`bronto_delivery_name` = '1 Newsletter B') then '1_Newsletter_B' when (`br`.`bronto_delivery_name` like 'GRTO Cancellation Confirmation') then 'GRTO Cancellation Confirmation' when (`br`.`bronto_delivery_name` = '1 WB60 30') then '1 WB60 30' when (`br`.`bronto_delivery_name` = '1 WB80 30') then '1 WB80 30' when (`br`.`bronto_delivery_name` = '1 WB90 30') then '1 WB90 30' when (`br`.`bronto_delivery_name` = '1 WB60 90') then '1 WB60 90' when (`br`.`bronto_delivery_name` = '1 WB80 90') then '1 WB80 90' when (`br`.`bronto_delivery_name` = '1 WB90 90') then '1 WB90 90' when (`br`.`bronto_delivery_name` like 'RE%') then `br`.`bronto_delivery_name` when (`br`.`bronto_delivery_name` like '%EQX%') then `br`.`bronto_delivery_name` when (`br`.`bronto_delivery_name` like 'GM%') then `br`.`bronto_delivery_name` when ((`br`.`bronto_delivery_name` like 'FDR%') or (`br`.`bronto_delivery_name` like 'Genesis%') or (`br`.`bronto_delivery_name` like 'Equifax%')) then `br`.`bronto_delivery_name` when (`br`.`bronto_delivery_name` like 'Trio%') then 'Trio' when (`br`.`bronto_delivery_name` like 'GEM%') then left(`br`.`bronto_delivery_name`,5) when (`br`.`bronto_delivery_name` like 'HSLGM%') then left(`br`.`bronto_delivery_name`,7) else 'NA' end) AS `email_message`,(case when (`br`.`bronto_delivery_name` like '%A') then 'Control A' when ((`br`.`bronto_delivery_name` like '%B') or (`br`.`bronto_delivery_name` like '%LexLaw')) then 'Challenger B' when (`br`.`bronto_delivery_name` like '%C') then 'Challenger C' else 'Other' end) AS `split_test_type`,`br`.`bronto_campaign_name` AS `bronto_campaign_name` from (`db03_reporting`.`bronto_remarketing_stats` `br` left join `nic_reporting`.`ips_by_brand` `brand` on(((`br`.`bronto_campaign_name` = convert(`brand`.`brand_name` using latin1)) and (`br`.`bronto_start_date` between `brand`.`start_date` and `brand`.`end_date`)))) 
group by `br`.`id`
